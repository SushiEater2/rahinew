<!DOCTYPE html>
<html>
<head>
    <title>Google Maps API Key Validator</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; max-width: 800px; }
        .input-section { background: #f5f5f5; padding: 20px; border-radius: 8px; margin: 20px 0; }
        .result { padding: 15px; border-radius: 8px; margin: 10px 0; }
        .success { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .error { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .warning { background: #fff3cd; color: #856404; border: 1px solid #ffeaa7; }
        .info { background: #d1ecf1; color: #0c5460; border: 1px solid #bee5eb; }
        input[type="text"] { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px; font-family: monospace; }
        button { padding: 12px 24px; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background: #0056b3; }
        .current-key { background: #e9ecef; padding: 15px; border-radius: 8px; margin: 15px 0; }
    </style>
</head>
<body>
    <h1>üîë Google Maps API Key Validator</h1>
    
    <div class="current-key">
        <h3>‚ùå Current Invalid Key:</h3>
        <code>AIzaSyADEiIWsJZyPAYwzejIFIP8AIzaSyADEiIWsJZyPAYwzejIFIP8-e_EHesQRVE</code>
        <p><strong>Issues:</strong> 67 characters long (should be 39), appears corrupted</p>
    </div>

    <div class="input-section">
        <h3>Test New API Key:</h3>
        <input type="text" id="apiKeyInput" placeholder="Paste your new Google Maps API key here (should be exactly 39 characters)" maxlength="100">
        <br>
        <button onclick="validateApiKey()">üß™ Validate API Key</button>
        <button onclick="clearResults()">üóëÔ∏è Clear Results</button>
    </div>

    <div id="results"></div>

    <div class="info result">
        <h4>üí° What to Look For:</h4>
        <ul>
            <li><strong>Valid Length:</strong> Exactly 39 characters</li>
            <li><strong>Valid Format:</strong> Starts with "AIza"</li>
            <li><strong>Working API:</strong> Can geocode Delhi successfully</li>
            <li><strong>No Console Errors:</strong> Google Maps loads without warnings</li>
        </ul>
    </div>

    <script>
        function addResult(message, type) {
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.innerHTML = message;
            document.getElementById('results').appendChild(div);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }

        async function validateApiKey() {
            clearResults();
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            
            if (!apiKey) {
                addResult('‚ùå Please enter an API key to test', 'error');
                return;
            }

            // Test 1: Format validation
            addResult('üîç <strong>Step 1:</strong> Checking API key format...', 'info');
            
            if (apiKey.length !== 39) {
                addResult(`‚ùå <strong>Invalid Length:</strong> ${apiKey.length} characters (should be exactly 39)`, 'error');
            } else {
                addResult('‚úÖ <strong>Length:</strong> 39 characters (correct)', 'success');
            }

            if (!apiKey.startsWith('AIza')) {
                addResult(`‚ùå <strong>Invalid Prefix:</strong> Should start with "AIza", got "${apiKey.substring(0, 4)}"`, 'error');
            } else {
                addResult('‚úÖ <strong>Prefix:</strong> Starts with "AIza" (correct)', 'success');
            }

            // Test 2: API functionality
            addResult('üîç <strong>Step 2:</strong> Testing API functionality...', 'info');
            
            try {
                const response = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=Delhi,India&key=${apiKey}`);
                const data = await response.json();
                
                if (data.status === 'OK') {
                    addResult('‚úÖ <strong>API Test:</strong> Geocoding API working successfully!', 'success');
                    addResult(`üìç <strong>Test Result:</strong> Found ${data.results.length} results for Delhi`, 'success');
                } else {
                    addResult(`‚ùå <strong>API Error:</strong> ${data.status} - ${data.error_message || 'Unknown error'}`, 'error');
                    
                    // Provide specific guidance based on error
                    if (data.status === 'REQUEST_DENIED') {
                        if (data.error_message?.includes('invalid')) {
                            addResult('üí° <strong>Solution:</strong> The API key is invalid. Get a new one from Google Cloud Console.', 'warning');
                        } else {
                            addResult('üí° <strong>Solution:</strong> Enable the Geocoding API in Google Cloud Console.', 'warning');
                        }
                    } else if (data.status === 'OVER_QUERY_LIMIT') {
                        addResult('üí° <strong>Solution:</strong> Check your billing settings or usage limits.', 'warning');
                    }
                }
            } catch (error) {
                addResult(`‚ùå <strong>Network Error:</strong> ${error.message}`, 'error');
            }

            // Test 3: Maps JavaScript API
            addResult('üîç <strong>Step 3:</strong> Testing Maps JavaScript API...', 'info');
            testMapsJavaScriptAPI(apiKey);
        }

        function testMapsJavaScriptAPI(apiKey) {
            // Remove any existing test scripts
            const existingScripts = document.querySelectorAll('script[src*="maps.googleapis.com"]');
            existingScripts.forEach(script => script.remove());
            
            // Set up success/failure handlers
            window.testMapCallback = function() {
                addResult('‚úÖ <strong>Maps JavaScript API:</strong> Loaded successfully!', 'success');
                addResult('üéâ <strong>Overall Result:</strong> API key is working and ready to use!', 'success');
            };

            window.gm_authFailure = function() {
                addResult('‚ùå <strong>Maps JavaScript API:</strong> Authentication failed', 'error');
                addResult('üí° <strong>Solution:</strong> Check API restrictions and ensure Maps JavaScript API is enabled.', 'warning');
            };

            // Load Maps JavaScript API
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&callback=testMapCallback`;
            script.onerror = function() {
                addResult('‚ùå <strong>Maps JavaScript API:</strong> Failed to load script', 'error');
            };
            
            document.head.appendChild(script);
        }

        // Auto-focus input
        document.getElementById('apiKeyInput').focus();
    </script>
</body>
</html>